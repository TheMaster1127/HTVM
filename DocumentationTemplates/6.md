### Pattern Matching

[Go back](#htvm-documentation)

HTVM provides a flexible and minimalist **`when`** block for pattern matching. It is designed to be highly intuitive, allowing you to write complex conditional logic with the least possible syntax and elegantly eliminating the verbosity of traditional `if-else` chains.

As a nod to developer convenience, HTVM includes a built-in alias: you can use **`wehn`** interchangeably with **`when`**, so a simple typo won't break your flow.

### A First Look at `when`

At a glance, the `when` block lets you handle different cases with unparalleled clarity. You can match against values, types, ranges, and lists all in one cohesive structure.

```htvm
%%%htvmSnippet74%%%

```

### The `->` Operator

The `->` operator is a core part of the `when` syntax. It serves a simple and clear purpose: to separate a pattern from its action.

Every pattern, from a single number to a complex expression, is followed by `->` to introduce the code that should run when the pattern matches. This creates a highly readable and consistent structure.

**Example:**

```htvm
%%%htvmSnippet75%%%

```

### Block Structures and `subout`

For actions that require multiple lines of code, you can start a new code block on the line immediately following the `->`.

The `subout` keyword is essential as it marks the end of the *entire* `when` or `wehn` structure, allowing for clear and predictable parsing, especially in nested scenarios.

```htvm
%%%htvmSnippet76%%%

```

### A Showcase of Pattern Types and Examples

Here is a comprehensive set of examples, starting with the basics and moving to more advanced use cases.

#### 1. Basic Value Matching

```htvm
%%%htvmSnippet77%%%

```

#### 2. Range Matching

```htvm
%%%htvmSnippet78%%%

```

#### 3. Expression-Based Matching (No Subject)

A `when` block can be used without a subject variable. This makes it a clean alternative to `if-else if` chains. This form is most powerful when you need to evaluate conditions that involve **several different variables**.

For example, identifying a starting sound in a word might depend on the first two letters. You cannot check both `firstLetter` and `secondLetter` on the same line using `when firstLetter`, so a subject-less `when` is ideal.

```htvm
%%%htvmSnippet79%%%

```

#### 4. Matching with Function Calls or Expressions

```htvm
%%%htvmSnippet80%%%

```

#### 5. Nested `when` Blocks

HTVM fully supports nesting `when` and `wehn` blocks for deep conditional logic.

```htvm
%%%htvmSnippet81%%%

```

#### 6. Input Validation Example

```htvm
%%%htvmSnippet82%%%

```

#### 7. Game State Logic Example

```htvm
%%%htvmSnippet83%%%

```

### Summary

*   **Keywords:** Use `when` or its alias `wehn` to start a pattern-matching block.
*   **The `->` Operator:** Separates a pattern from its action (e.g., `5 -> print("Five")`).
*   **Blocks:** Use `subout` which is required to explicitly end the entire `when` structure. For multi-line actions, begin a code block on the line after `->`.
*   **The `else` Branch:** This is an optional catch-all case that never uses the `->` operator. If omitted, and no other patterns match, execution simply continues after the `subout`.
*   **Rich Patterns:** HTVM supports a wide variety of patterns, including single values, ranges (`..`), multi-value lists (`,`), expressions, and the results of function calls.

### Notes and Best Practices

*   **Readability is Key:** The consistent use of `->` gives `when` blocks a predictable structure, making code easier to read and maintain across projects.
*   **Leverage the Optional `else`:** The fact that the `else` branch is not required is a powerful feature for writing concise code. Use it when you only need to act on a few specific cases and want to ignore all others.
*   **Embrace Nesting:** Don't be afraid to nest `when` blocks. It is often much cleaner and more readable than deeply nested `if` statements or complex boolean logic.

---